var N=Object.defineProperty;var H=(o,e,t)=>e in o?N(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var m=(o,e,t)=>(H(o,typeof e!="symbol"?e+"":e,t),t);import{G as V,B as f,M as p,a as l,V as _,W as X,b as Y,S as U,O as Z,A as J,c as Q,d as $,C as ee,P as te,e as v,f as oe,D as ne}from"./vendor.2fb950bb.js";const ie=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}};ie();const r={};window.addEventListener("keydown",function(o){r[o.code]=!0});window.addEventListener("keyup",function(o){r[o.code]=!1});var W;(W=document.querySelector("#left"))==null||W.addEventListener("touchstart",function(){r.left=!0});var q;(q=document.querySelector("#left"))==null||q.addEventListener("touchend",function(){r.left=!1});var C;(C=document.querySelector("#right"))==null||C.addEventListener("touchstart",function(){r.right=!0});var G;(G=document.querySelector("#right"))==null||G.addEventListener("touchend",function(){r.right=!1});var O;(O=document.querySelector("#accellerate"))==null||O.addEventListener("touchstart",function(){r.accellerate=!0});var B;(B=document.querySelector("#accellerate"))==null||B.addEventListener("touchend",function(){r.accellerate=!1});var D;(D=document.querySelector("#break"))==null||D.addEventListener("touchstart",function(){r.break=!0});var I;(I=document.querySelector("#break"))==null||I.addEventListener("touchend",function(){r.break=!1});const A=3,y=Math.PI/4;class re{constructor(){m(this,"object");m(this,"velocity",0);m(this,"accelleration",0);m(this,"turn",0);this.object=this.createObject()}update(e){const t=r.KeyA||r.left||r.ArrowLeft,a=r.KeyD||r.right||r.ArrowRight,n=r.KeyW||r.accellerate||r.ArrowUp,i=r.KeyS||r.break||r.ArrowDown;t?(this.turn=Math.min(y,this.turn+.1),this.turn=Math.max(-y,this.turn)):a?(this.turn=Math.min(y,this.turn-.1),this.turn=Math.max(-y,this.turn)):(this.turn*=.8,Math.abs(this.turn)<.01&&(this.turn=0)),n?this.accelleration=.1:i?this.accelleration=-.1:(this.accelleration=0,this.velocity*=.95,Math.abs(this.velocity)<.01&&(this.velocity=0)),this.velocity=Math.min(A,this.velocity+this.accelleration),this.velocity=Math.max(-A,this.velocity),this.velocity!=0&&this.turn!=0&&this.object.rotateY(this.turn*this.velocity*e),this.object.translateZ(this.velocity)}createObject(){const e=new V,t=new f(10.6,4,4),a=new p({color:3355443}),n=new l(t,a);n.position.z=5.5;const i=new f(10.6,4,4),d=new p({color:3355443}),x=new l(i,d);x.position.z=-5.5;const R=new f(10,5,20),T=new p({color:1154734}),g=new l(R,T);g.position.y=2,g.castShadow=!0;const F=new f(8,5,10),K=new p({color:16777215}),M=new l(F,K);return M.position.y=7,M.position.z=-1,e.add(n),e.add(x),e.add(g),e.add(M),e.position.y=2,e}}const ae=document.getElementById("score"),L=document.getElementById("start"),S=new _(-100,200,200),w=new X({antialias:!0,canvas:document.querySelector("canvas")});w.setPixelRatio(window.devicePixelRatio);w.setSize(window.innerWidth,window.innerHeight);w.shadowMap.enabled=!0;w.shadowMap.type=Y;const u=new U,s=new Z,j=new J;s.add(j);const se=new Q,ce=["Fluffing-a-Duck.mp3","pickupCoin.wav"];let b=[];Promise.all(ce.map(o=>new Promise((e,t)=>{se.load(o,function(a){const n=new $(j);n.setBuffer(a),n.setVolume(.1),e(n)},function(){},function(a){t(a)})}))).then(o=>{L.innerText="Start",L.addEventListener("click",function(){this.remove(),z(),o[0].play()}),b=o}).catch(o=>{L.innerText=o.toString()});he(u);const k=ue();u.add(k);const c=new re;u.add(c.object);fe(u);const de=we(u),le=new ee;let P=0;function z(){window.requestAnimationFrame(z);const o=le.getDelta();c.update(o);for(const e of de){if(!e.visible)continue;Math.pow(e.position.x-c.object.position.x,2)+Math.pow(e.position.y-c.object.position.y,2)+Math.pow(e.position.z-c.object.position.z,2)<10*10&&(u.remove(e),P++,e.visible=!1,ae.innerText=P.toString(),b[1].isPlaying&&b[1].stop(),b[1].play(0))}s.position.set(c.object.position.x+S.x,c.object.position.y+S.y,c.object.position.z+S.z),k.position.set(c.object.position.x,0,c.object.position.z),w.render(u,s)}let h=150;function E(){const o=window.innerWidth/window.innerHeight,e=h*o;s.left=e/-2,s.right=e/2,s.top=h/2,s.bottom=h/-2,s.updateProjectionMatrix()}E();s.position.set(-100,200,200);s.lookAt(0,0,0);window.addEventListener("resize",function(){E(),w.setSize(window.innerWidth,window.innerHeight)});window.addEventListener("wheel",function(o){h=Math.max(50,h+Math.sign(o.deltaY)*50),h=Math.min(500,h),E()});function ue(){const o=new te(1e3,1e3),e=new v({color:4473924}),t=new l(o,e);return t.rotateX(-Math.PI/2),t.receiveShadow=!0,t}function he(o){const e=new oe(16777215,.5);o.add(e);const t=new ne(16777215,.7);t.position.set(100,300,50),t.castShadow=!0,t.shadow.mapSize.width=4096,t.shadow.mapSize.height=4096,t.shadow.camera.left=-1e3,t.shadow.camera.right=1e3,t.shadow.camera.top=1e3,t.shadow.camera.bottom=-1e3,t.shadow.camera.near=.5,t.shadow.camera.far=500,o.add(t)}function fe(o){for(let e=0;e<200;e++){const t=(Math.random()-.5)*1500,a=(Math.random()-.5)*1500,n=Math.random()*Math.PI*2,i=5+Math.random()*20,d=me(t,a,i);d.rotation.y=n,o.add(d)}}function we(o){const e=new Array(200);for(let t=0;t<e.length;t++){const a=(Math.random()-.5)*1500,n=(Math.random()-.5)*1500,i=pe(a,n);o.add(i),e[t]=i}return e}function me(o,e,t){const a=new f(t,t,t),n=new v({color:11184810}),i=new l(a,n);return i.castShadow=!0,i.position.set(o,t/2,e),i}function pe(o,e){const t=new f(4,4,4),a=new v({color:43520}),n=new l(t,a);return n.castShadow=!0,n.position.set(o,3,e),n}
