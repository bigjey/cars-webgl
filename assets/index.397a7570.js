var K=Object.defineProperty;var Y=(o,e,t)=>e in o?K(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var m=(o,e,t)=>(Y(o,typeof e!="symbol"?e+"":e,t),t);import{G as H,B as f,M as p,a as d,V as U,W as X,b as Z,S as J,O as Q,A as $,c as ee,d as te,C as oe,P as ne,e as L,f as ie,D as re}from"./vendor.2fb950bb.js";const se=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}};se();const r={};window.addEventListener("keydown",function(o){r[o.code]=!0});window.addEventListener("keyup",function(o){r[o.code]=!1});var T;(T=document.querySelector("#left"))==null||T.addEventListener("touchstart",function(){r.left=!0});var z;(z=document.querySelector("#left"))==null||z.addEventListener("touchend",function(){r.left=!1});var N;(N=document.querySelector("#right"))==null||N.addEventListener("touchstart",function(){r.right=!0});var G;(G=document.querySelector("#right"))==null||G.addEventListener("touchend",function(){r.right=!1});var R;(R=document.querySelector("#accellerate"))==null||R.addEventListener("touchstart",function(){r.accellerate=!0});var W;(W=document.querySelector("#accellerate"))==null||W.addEventListener("touchend",function(){r.accellerate=!1});var q;(q=document.querySelector("#break"))==null||q.addEventListener("touchstart",function(){r.break=!0});var _;(_=document.querySelector("#break"))==null||_.addEventListener("touchend",function(){r.break=!1});const v=4,C=5,ae=.95,y=60*(Math.PI/180),j=10,ce=.8;class le{constructor(){m(this,"object");m(this,"velocity",0);m(this,"accelleration",0);m(this,"turn",0);this.object=this.createObject()}update(e){const t=r.KeyA||r.left||r.ArrowLeft,s=r.KeyD||r.right||r.ArrowRight,n=r.KeyW||r.accellerate||r.ArrowUp,i=r.KeyS||r.break||r.ArrowDown;t?(this.turn=Math.min(y,this.turn+j*e),this.turn=Math.max(-y,this.turn)):s?(this.turn=Math.min(y,this.turn-j*e),this.turn=Math.max(-y,this.turn)):(this.turn*=ce,Math.abs(this.turn)<.01&&(this.turn=0)),n?this.accelleration=C:i?this.accelleration=-C:(this.accelleration=0,this.velocity*=ae,Math.abs(this.velocity)<.01&&(this.velocity=0)),this.velocity=Math.min(v,this.velocity+this.accelleration*e),this.velocity=Math.max(-v,this.velocity),this.velocity!=0&&(this.turn!=0&&this.object.rotateY(this.turn*this.velocity*e),this.object.translateZ(this.velocity))}get speedIndex(){return this.velocity/v}createObject(){const e=new H,t=new f(10.6,4,4),s=new p({color:3355443}),n=new d(t,s);n.position.z=5.5;const i=new f(10.6,4,4),l=new p({color:3355443}),x=new d(i,l);x.position.z=-5.5;const D=new f(10,5,20),B=new p({color:1154734}),M=new d(D,B);M.position.y=2,M.castShadow=!0;const V=new f(8,5,10),F=new p({color:16777215}),g=new d(V,F);return g.position.y=7,g.position.z=-1,e.add(n),e.add(x),e.add(M),e.add(g),e.position.y=2,e}}const de=document.getElementById("score"),E=document.getElementById("start"),A=new U(-100,200,200),w=new X({antialias:!0,canvas:document.querySelector("canvas")});w.setPixelRatio(window.devicePixelRatio);w.setSize(window.innerWidth,window.innerHeight);w.shadowMap.enabled=!0;w.shadowMap.type=Z;const u=new J,a=new Q,k=new $;a.add(k);const ue=new ee,he=["Fluffing-a-Duck.mp3","pickupCoin.wav"];let b=[];Promise.all(he.map(o=>new Promise((e,t)=>{ue.load(o,function(s){const n=new te(k);n.setBuffer(s),n.setVolume(.1),e(n)},function(){},function(s){t(s)})}))).then(o=>{E.innerText="Start",E.addEventListener("click",function(){this.remove(),O(),o[0].play()}),b=o}).catch(o=>{E.innerText=o.toString()});pe(u);const P=me();u.add(P);const c=new le;u.add(c.object);ye(u);const fe=be(u),we=new oe;let I=0;function O(){window.requestAnimationFrame(O);const o=we.getDelta();c.update(o);for(const e of fe){if(!e.visible)continue;Math.pow(e.position.x-c.object.position.x,2)+Math.pow(e.position.y-c.object.position.y,2)+Math.pow(e.position.z-c.object.position.z,2)<10*10&&(u.remove(e),I++,e.visible=!1,de.innerText=I.toString(),b[1].isPlaying&&b[1].stop(),b[1].play(0))}a.position.set(c.object.position.x+A.x,c.object.position.y+A.y,c.object.position.z+A.z),P.position.set(c.object.position.x,0,c.object.position.z),w.render(u,a)}let h=250;function S(){const o=window.innerWidth/window.innerHeight,e=h*o;a.left=e/-2,a.right=e/2,a.top=h/2,a.bottom=h/-2,a.updateProjectionMatrix()}S();a.position.set(-100,200,200);a.lookAt(0,0,0);window.addEventListener("resize",function(){S(),w.setSize(window.innerWidth,window.innerHeight)});window.addEventListener("wheel",function(o){h=Math.max(50,h+Math.sign(o.deltaY)*50),h=Math.min(500,h),S()});function me(){const o=new ne(1e3,1e3),e=new L({color:4473924}),t=new d(o,e);return t.rotateX(-Math.PI/2),t.receiveShadow=!0,t}function pe(o){const e=new ie(16777215,.5);o.add(e);const t=new re(16777215,.7);t.position.set(100,300,50),t.castShadow=!0,t.shadow.mapSize.width=4096,t.shadow.mapSize.height=4096,t.shadow.camera.left=-1e3,t.shadow.camera.right=1e3,t.shadow.camera.top=1e3,t.shadow.camera.bottom=-1e3,t.shadow.camera.near=.5,t.shadow.camera.far=500,o.add(t)}function ye(o){for(let e=0;e<200;e++){const t=(Math.random()-.5)*1500,s=(Math.random()-.5)*1500,n=Math.random()*Math.PI*2,i=5+Math.random()*20,l=Me(t,s,i);l.rotation.y=n,o.add(l)}}function be(o){const e=new Array(200);for(let t=0;t<e.length;t++){const s=(Math.random()-.5)*1500,n=(Math.random()-.5)*1500,i=ge(s,n);o.add(i),e[t]=i}return e}function Me(o,e,t){const s=new f(t,t,t),n=new L({color:11184810}),i=new d(s,n);return i.castShadow=!0,i.position.set(o,t/2,e),i}function ge(o,e){const t=new f(4,4,4),s=new L({color:43520}),n=new d(t,s);return n.castShadow=!0,n.position.set(o,3,e),n}
